#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
utils.py  â€¢ Ğ²ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¸ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹ VayboMeter-Ğ±Ğ¾Ñ‚Ğ°
"""

from __future__ import annotations
import logging, math, time, random, requests, pendulum
from typing import Any, Dict, Optional, List

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ĞšĞ¾Ğ¼Ğ¿Ğ°Ñ, Ğ¾Ğ±Ğ»Ğ°ĞºĞ°, Ğ²ĞµÑ‚ĞµÑ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
COMPASS = [
    "N","NNE","NE","ENE","E","ESE","SE","SSE",
    "S","SSW","SW","WSW","W","WNW","NW","NNW"
]

def compass(deg: float) -> str:
    return COMPASS[int((deg/22.5)+.5) % 16]

def clouds_word(pc: int) -> str:
    if pc < 25:  return "ÑÑĞ½Ğ¾"
    if pc < 70:  return "Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ"
    return "Ğ¿Ğ°ÑĞ¼ÑƒÑ€Ğ½Ğ¾"

def wind_phrase(km_h: float) -> str:
    if km_h < 2:   return "ÑˆÑ‚Ğ¸Ğ»ÑŒ"
    if km_h < 8:   return "ÑĞ»Ğ°Ğ±Ñ‹Ğ¹"
    if km_h < 14:  return "ÑƒĞ¼ĞµÑ€ĞµĞ½Ğ½Ñ‹Ğ¹"
    return "ÑĞ¸Ğ»ÑŒĞ½Ñ‹Ğ¹"

def safe(v: Any, unit: str = "") -> str:
    """None â†’ Â«â€”Â»; Ñ‡Ğ¸ÑĞ»Ğ¾ â†’ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ° Ñ unit."""
    if v in (None, "None", "â€”"):
        return "â€”"
    return f"{v:.1f}{unit}" if isinstance(v, (int, float)) else f"{v}{unit}"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AQI & PM Ñ€Ğ°ÑĞºÑ€Ğ°ÑĞºĞ° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def aqi_color(aqi: int | float | str) -> str:
    if aqi in ("â€”", "Ğ½/Ğ´"): return "âšª"
    aqi = float(aqi)
    if aqi <=  50: return "ğŸŸ¢"
    if aqi <= 100: return "ğŸŸ¡"
    if aqi <= 150: return "ğŸŸ "
    if aqi <= 200: return "ğŸ”´"
    if aqi <= 300: return "ğŸŸ£"
    return "ğŸŸ¤"

def pm_color(pm: Optional[float | int | str], with_unit: bool = False) -> str:
    """
    Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ†Ğ¸Ğ¹ PMâ‚‚.â‚… / PMâ‚â‚€.
    â–¸ Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚, Ğ½Ğ°Ğ¿Ñ€., Â«ğŸŸ¡27Â» Ğ¸Ğ»Ğ¸ Â«ğŸŸ¢ 8 Âµg/Ğ¼Â³Â», ĞµÑĞ»Ğ¸ with_unit=True
    """
    if pm in (None, "â€”", "Ğ½/Ğ´"):
        return "âšª Ğ½/Ğ´"
    try:
        val = float(pm)
    except (TypeError, ValueError):
        return "âšª Ğ½/Ğ´"

    if val <= 12:    col = "ğŸŸ¢"
    elif val <= 35:  col = "ğŸŸ¡"
    elif val <= 55:  col = "ğŸŸ "
    elif val <=150:  col = "ğŸ”´"
    elif val <=250:  col = "ğŸŸ£"
    else:            col = "ğŸŸ¤"

    txt = f"{int(round(val))}"
    if with_unit:
        txt += " Âµg/Ğ¼Â³"
    return f"{col}{txt}"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Â«Ğ¤Ğ°ĞºÑ‚ Ğ´Ğ½ÑÂ» â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FACTS: Dict[str, str] = {
    # ÑƒĞ¶Ğµ Ğ±Ñ‹Ğ»Ğ¸:
    "05-11": "11 Ğ¼Ğ°Ñ â€” Ğ”ĞµĞ½ÑŒ Ğ¼Ğ¾Ñ€ÑĞºĞ¾Ğ³Ğ¾ Ğ±Ñ€Ğ¸Ğ·Ğ° Ğ½Ğ° ĞšĞ¸Ğ¿Ñ€Ğµ ğŸŒ¬ï¸",
    "06-08": "8 Ğ¸ÑĞ½Ñ 2004 â€” Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ¸Ñ‚ Ğ’ĞµĞ½ĞµÑ€Ñ‹ Ğ¿Ğ¾ Ğ´Ğ¸ÑĞºÑƒ Ğ¡Ğ¾Ğ»Ğ½Ñ†Ğ° ğŸŒ",
    "07-20": "20 Ğ¸ÑĞ»Ñ â€” Ğ½Ğ° ĞšĞ¸Ğ¿Ñ€Ğµ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ¶Ğ°Ğ¹ Ğ²Ğ¸Ğ½Ğ¾Ğ³Ñ€Ğ°Ğ´Ğ° ğŸ‡",
    "10-01": "1 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ â€” Ğ”ĞµĞ½ÑŒ ĞšĞ¸Ğ¿Ñ€Ğ° ğŸ‡¨ğŸ‡¾",
    # Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ·Ğ´Ğ½Ğ¸ĞºĞ¸:
    "01-01": "1 ÑĞ½Ğ²Ğ°Ñ€Ñ â€” ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ³Ğ¾Ğ´ Ğ½Ğ° ĞšĞ¸Ğ¿Ñ€Ğµ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ñ Ñ„ĞµĞ¹ĞµÑ€Ğ²ĞµÑ€ĞºĞ¾Ğ² Ğ½Ğ°Ğ´ ÑÑ‚Ğ°Ñ€Ğ¸Ğ½Ğ½Ñ‹Ğ¼Ğ¸ ĞºÑ€ĞµĞ¿Ğ¾ÑÑ‚ÑĞ¼Ğ¸ ğŸ†",
    "01-06": "6 ÑĞ½Ğ²Ğ°Ñ€Ñ â€” ĞšÑ€ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ“Ğ¾ÑĞ¿Ğ¾Ğ´Ğ½Ğµ: Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞ¼ĞµĞ»ÑŒÑ‡Ğ°ĞºĞ¸ Ğ¾ĞºÑƒĞ½Ğ°ÑÑ‚ÑÑ Ğ² Ğ¡Ñ€ĞµĞ´Ğ¸Ğ·ĞµĞ¼Ğ½Ğ¾Ğµ Ğ¼Ğ¾Ñ€Ğµ â„ï¸",
    "02-14": "14 Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ â€” Ğ”ĞµĞ½ÑŒ ÑĞ²ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ’Ğ°Ğ»ĞµĞ½Ñ‚Ğ¸Ğ½Ğ°: Ğ»ÑĞ±Ğ¾Ğ²ÑŒ Ğ²Ğ¸Ñ‚Ğ°ĞµÑ‚ Ğ² Ğ²Ğ¾Ğ·Ğ´ÑƒÑ…Ğµ, Ğ° Ñ€Ñ‹Ğ½ĞºĞ¸ Ğ·Ğ°Ğ²Ğ°Ğ»ĞµĞ½Ñ‹ Ğ¼Ğ¸Ğ¼Ğ¾Ğ·Ğ°Ğ¼Ğ¸ Ğ¸ Ğ²Ğ¸Ğ½Ğ¾Ğ³Ñ€Ğ°Ğ´Ğ¾Ğ¼ ğŸ’",
    "02-25": "25 Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ â€” Ğ§Ğ¸ÑÑ‚Ñ‹Ğ¹ Ğ¿Ğ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº (ĞšĞ°Ñ‚Ğ°ĞºĞ»Ğ¸Ğ·Ğ¼Ğ¾Ñ): Ğ½Ğ°Ñ€Ğ¾Ğ´ Ğ¾Ñ‚Ğ¼ĞµÑ‡Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ·Ğ´Ğ½Ğ¸Ğº Ğ²Ğ¾Ğ´ Ğ¸ Ğ²ĞµÑĞ½Ñ‹ ğŸŒŠ",
    "03-08": "8 Ğ¼Ğ°Ñ€Ñ‚Ğ° â€” ĞœĞµĞ¶Ğ´ÑƒĞ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ¶ĞµĞ½ÑĞºĞ¸Ğ¹ Ğ´ĞµĞ½ÑŒ: Ñ†Ğ²ĞµÑ‚Ñ‹ Ğ¸ Ğ¿Ğ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ´Ğ°Ğ¼ ğŸ’",
    "03-25": "25 Ğ¼Ğ°Ñ€Ñ‚Ğ° â€” Ğ”ĞµĞ½ÑŒ Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ“Ñ€ĞµÑ†Ğ¸Ğ¸: Ğ½Ğ° ÑĞµĞ²ĞµÑ€Ğ½Ğ¾Ğ¼ ĞšĞ¸Ğ¿Ñ€Ğµ Ñ‚Ğ¾Ğ¶Ğµ Ğ·Ğ²ÑƒÑ‡Ğ°Ñ‚ Ğ¼Ğ°Ñ€ÑˆĞ¸ Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ´Ñ‹ ğŸ‡¬ğŸ‡·",
    "04-01": "1 Ğ°Ğ¿Ñ€ĞµĞ»Ñ â€” Ğ”ĞµĞ½ÑŒ ÑĞ¼ĞµÑ…Ğ°: Ğ½Ğ° ĞšĞ¸Ğ¿Ñ€Ğµ ÑˆÑƒÑ‚ÑÑ‚ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸ Ğ¸ Ğ½Ğ° Ğ¿Ğ»ÑĞ¶Ğµ ÑÑ‚Ñ€Ğ¾ÑÑ‚ Ğ¿ĞµÑÑ‡Ğ°Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¼ĞºĞ¸ ğŸ¤¡",
    "05-01": "1 Ğ¼Ğ°Ñ â€” Ğ”ĞµĞ½ÑŒ Ñ‚Ñ€ÑƒĞ´Ğ° Ğ¸ Ñ†Ğ²ĞµÑ‚ÑƒÑ‰Ğ¸Ñ… Ğ¼Ğ°ĞºĞ¾Ğ²: Ğ² Ğ³Ğ¾Ñ€Ğ°Ñ… ĞºĞ¸Ğ¿ÑÑ‚ Ğ³ÑƒĞ»ÑĞ½ÑŒÑ Ğ¸ Ğ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ñ‹Ğµ Ñ‚Ğ°Ğ½Ñ†Ñ‹ ğŸŒº",
    "06-21": "21 Ğ¸ÑĞ½Ñ â€” Ğ”ĞµĞ½ÑŒ Ğ»ĞµÑ‚Ğ½ĞµĞ³Ğ¾ ÑĞ¾Ğ»Ğ½Ñ†ĞµÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ: ÑĞ°Ğ¼Ñ‹Ğ¹ Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ³Ğ¾Ğ´Ğ° â˜€ï¸",
    "06-29": "29 Ğ¸ÑĞ½Ñ â€” ĞŸÑ€Ğ°Ğ·Ğ´Ğ½Ğ¸Ğº ÑĞ²ÑÑ‚Ñ‹Ñ… ĞŸĞµÑ‚Ñ€Ğ° Ğ¸ ĞŸĞ°Ğ²Ğ»Ğ° Ğ² ĞŸĞ°Ñ„Ğ¾ÑĞµ: Ğ±Ğ¾Ğ³Ğ¾ÑĞ»ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ¸ Ğ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ³ÑƒĞ»ÑĞ½ÑŒÑ ğŸ•",
    "08-15": "15 Ğ°Ğ²Ğ³ÑƒÑÑ‚Ğ° â€” Ğ£ÑĞ¿ĞµĞ½Ğ¸Ğµ Ğ‘Ğ¾Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¸Ñ†Ñ‹ (ĞŸĞ°Ğ½Ğ°Ğ¹Ñ): ĞºÑ€ÑƒĞ¿Ğ½ĞµĞ¹ÑˆĞ¸Ğ¹ Ñ€ĞµĞ»Ğ¸Ğ³Ğ¸Ğ¾Ğ·Ğ½Ñ‹Ğ¹ Ñ„ĞµÑÑ‚Ğ¸Ğ²Ğ°Ğ»ÑŒ Ğ¾ÑÑ‚Ñ€Ğ¾Ğ²Ğ° â›ªï¸",
    "08-16": "16 Ğ°Ğ²Ğ³ÑƒÑÑ‚Ğ° â€” Ğ”ĞµĞ½ÑŒ ĞšĞ¾Ğ½ÑÑ‚Ğ¸Ñ‚ÑƒÑ†Ğ¸Ğ¸ ĞšĞ¸Ğ¿Ñ€Ğ°: Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ Ğ¿Ğ°Ñ€Ğ°Ğ´Ğ°Ğ¼Ğ¸ Ğ¸ ĞºĞ¾Ğ½Ñ†ĞµÑ€Ñ‚Ğ¾Ğ¼ ğŸ“œ",
    "09-21": "21 ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ â€” ĞœĞµĞ¶Ğ´ÑƒĞ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¼Ğ¸Ñ€Ğ°: Ñ„Ğ»Ğ°Ğ³Ğ¸ Ğ¼Ğ¸Ñ€Ğ° Ğ½Ğ°Ğ´ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¼ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ¼ ĞĞ¸ĞºĞ¾ÑĞ¸Ğ¸ ğŸ•Šï¸",
    "10-11": "11 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ â€” Ğ”ĞµĞ½ÑŒ ÑĞ²ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ’Ğ°Ñ€Ğ½Ğ°Ğ²Ñ‹: Ğ¿Ğ¾Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ĞºÑ€Ğ¾Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒ ĞšĞ¸Ğ¿Ñ€ÑĞºĞ¾Ğ¹ Ñ†ĞµÑ€ĞºĞ²Ğ¸ ğŸ™",
    "10-31": "31 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ â€” Ğ”ĞµĞ½ÑŒ ÑĞ²ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ›ÑƒĞºĞ¸: Ğ² Ğ´ĞµÑ€ĞµĞ²Ğ½ÑÑ… Ğ³Ñ€ĞµÑÑ‚ ĞºÑ€Ğ°ÑĞ½Ğ¾Ğµ Ğ²Ğ¸Ğ½Ğ¾ Ğ¸ ÑƒĞ³Ğ¾Ñ‰Ğ°ÑÑ‚ ĞºĞ¾Ğ·Ñƒ ğŸ˜‚ğŸ·",
    "11-01": "1 Ğ½Ğ¾ÑĞ±Ñ€Ñ â€” Ğ”ĞµĞ½ÑŒ Ğ²ÑĞµÑ… ÑĞ²ÑÑ‚Ñ‹Ñ…: Ğ´Ğ¾Ğ¼Ğ° ÑƒĞºÑ€Ğ°ÑˆĞ°ÑÑ‚ ÑĞ¾Ğ»Ğ¾Ğ¼ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ²ĞµĞ½ĞºĞ°Ğ¼Ğ¸ Ğ¸ ÑĞ²ĞµÑ‡Ğ°Ğ¼Ğ¸ ğŸ•¯ï¸",
    "12-24": "24 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ â€” Ğ¡Ğ¾Ñ‡ĞµĞ»ÑŒĞ½Ğ¸Ğº Ğ Ğ¾Ğ¶Ğ´ĞµÑÑ‚Ğ²Ğ°: ÑĞµĞ¼ÑŒĞ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑÑ‚ Â«Ğ¼Ğ°Ñ…Ğ°Ğ»Ğ»Ğ¾Â» Ğ¸ ÑĞ»Ğ°Ğ´Ğ¾ÑÑ‚Ğ¸ ğŸ„",
    "12-25": "25 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ â€” Ğ Ğ¾Ğ¶Ğ´ĞµÑÑ‚Ğ²Ğ¾: ÑƒĞ»Ğ¸Ñ†Ñ‹ ĞĞ¸ĞºĞ¾ÑĞ¸Ğ¸ ÑĞ²ĞµÑ€ĞºĞ°ÑÑ‚ Ğ³Ğ¸Ñ€Ğ»ÑĞ½Ğ´Ğ°Ğ¼Ğ¸ Ğ¸ ÑÑ€Ğ¼Ğ°Ñ€ĞºĞ°Ğ¼Ğ¸ ğŸ",
    "12-26": "26 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ â€” Boxing Day: Ñ€Ğ°ÑĞ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ¸ ÑĞµĞ¼ĞµĞ¹Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑĞ¸Ğ´ĞµĞ»ĞºĞ¸ Ğ² Ğ¿Ñ€Ğ¸Ğ±Ñ€ĞµĞ¶Ğ½Ñ‹Ñ… ĞºĞ°Ñ„Ğµ ğŸ›ï¸",
    "12-31": "31 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ â€” ĞšĞ°Ğ½ÑƒĞ½ ĞĞ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ³Ğ¾Ğ´Ğ°: Ğ¿Ğ»ÑĞ¶Ğ¸ Ğ¸ Ğ½Ğ°Ğ±ĞµÑ€ĞµĞ¶Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑÑÑ‚ÑÑ Ğ³ÑƒĞ»ÑĞºĞ°Ğ¼Ğ¸ Ğ´Ğ¾ ÑƒÑ‚Ñ€Ğ° ğŸ¥‚",
}

def get_fact(d: pendulum.Date) -> str:
    """
    Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ°ĞºÑ‚ Ğ´Ğ»Ñ Ğ´Ğ°Ñ‚Ñ‹ d (MM-DD), 
    Ğ»Ğ¸Ğ±Ğ¾ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°ĞºÑ‚.
    """
    return FACTS.get(
        d.format("MM-DD"),
        "ĞĞ° ĞšĞ¸Ğ¿Ñ€Ğµ Ğ² Ğ³Ğ¾Ğ´Ñƒ â‰ˆ 340 ÑĞ¾Ğ»Ğ½ĞµÑ‡Ğ½Ñ‹Ñ… Ğ´Ğ½ĞµĞ¹ â˜€ï¸"
    )

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ˜ĞºĞ¾Ğ½ĞºĞ¸ & Ñ†Ğ²ĞµÑ‚Ğ° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WEATHER_ICONS = {
    "ÑÑĞ½Ğ¾":"â˜€ï¸","Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ":"ğŸŒ¤ï¸","Ğ¿Ğ°ÑĞ¼ÑƒÑ€Ğ½Ğ¾":"â˜ï¸",
    "Ğ´Ğ¾Ğ¶Ğ´ÑŒ":"ğŸŒ§ï¸","Ñ‚ÑƒĞ¼Ğ°Ğ½":"ğŸŒ"
}
AIR_EMOJI = {
    "Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹":"ğŸŸ¢","ÑƒĞ¼ĞµÑ€ĞµĞ½Ğ½Ñ‹Ğ¹":"ğŸŸ¡","Ğ²Ñ€ĞµĞ´Ğ½Ñ‹Ğ¹":"ğŸŸ ",
    "Ğ¾Ñ‡. Ğ²Ñ€ĞµĞ´Ğ½Ñ‹Ğ¹":"ğŸ”´","Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹":"ğŸŸ£","Ğ½/Ğ´":"âšª"
}

K_COLOR = {
    "green":  range(0, 4),
    "yellow": range(4, 6),
    "red":    range(6, 10),
}
def kp_emoji(kp: float) -> str:
    k = int(round(kp))
    if k in K_COLOR["green"]:   return "ğŸŸ¢"
    if k in K_COLOR["yellow"]:  return "ğŸŸ¡"
    return "ğŸ”´"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ¢Ñ€ĞµĞ½Ğ´ Ğ´Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def pressure_trend(w: Dict[str, Any]) -> str:
    """
    â†‘ ĞµÑĞ»Ğ¸ Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğ¹ Ñ‡Ğ°Ñ > +2 Ğ³ĞŸĞ°, â†“ < âˆ’2 Ğ³ĞŸĞ°, Ğ¸Ğ½Ğ°Ñ‡Ğµ â†’.
    w â€” Ğ¾Ğ±ÑŠĞµĞºÑ‚, Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ· get_weather().
    """
    hp = w.get("hourly", {}).get("surface_pressure", [])
    if len(hp) < 2:
        return "â†’"
    diff = hp[1] - hp[0]
    if   diff >= 2:  return "â†‘"
    elif diff <= -2: return "â†“"
    return "â†’"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HTTP-Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
_HEADERS = {
    "User-Agent": "VayboMeter/1.0 (+https://github.com/)",
    "Accept":     "application/json",
}

def _get_retry(url: str, retries: int = 2, **params) -> Optional[dict]:
    attempt = 0
    while attempt <= retries:
        try:
            r = requests.get(url, params=params, timeout=15, headers=_HEADERS)
            r.raise_for_status()
            return r.json()
        except Exception as e:
            attempt += 1
            if attempt > retries:
                logging.warning("%s â€“ %s (attempts=%d)",
                                url.split("/")[2], e, attempt)
                return None
            time.sleep(0.5 * attempt)

def _get(url: str, **params) -> Optional[dict]:
    """Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸: 2 Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸."""
    return _get_retry(url, retries=2, **params)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ module self-test â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if __name__ == "__main__":
    print("pm_color demo:", pm_color(8), pm_color(27), pm_color(78, True), pm_color(None))
    print("AQI demo:", aqi_color(42), aqi_color(160), aqi_color("â€”"))
    print("Fact today:", get_fact(pendulum.today()))
