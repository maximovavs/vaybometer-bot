#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
gen_lunar_calendar.py
~~~~~~~~~~~~~~~~~~~~~
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª lunar_calendar.json –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Å–æ–≤–µ—Ç–∞–º–∏:
  - phase:          —Å—Ç—Ä–æ–∫–∞ —Å —Ñ–∞–∑–æ–π –õ—É–Ω—ã + –∑–Ω–∞–∫ + "(XX% –æ—Å–≤–µ—â.)"
  - advice:         —Å–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–∑—ã–≤–æ–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é (3 —Å–æ–≤–µ—Ç–∞)
  - next_event:     –∫—Ä–∞—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –±–ª–∏–∂–∞–π—à–µ–µ –∞—Å—Ç—Ä–æ—Å–æ–±—ã—Ç–∏–µ
  - favorable_days: —Å–ª–æ–≤–∞—Ä—å —Å–ø–∏—Å–∫–æ–≤ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö –¥–Ω–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
  - unfavorable_days: —Å–ª–æ–≤–∞—Ä—å —Å–ø–∏—Å–∫–æ–≤ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö –¥–Ω–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
"""

import os
import json
import random
from pathlib import Path
import pendulum
from typing import Dict, Any, List, Tuple

# –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ openai
 try:
     from openai import OpenAI
     OPENAI_KEY = os.getenv("OPENAI_API_KEY")
     client = OpenAI(api_key=OPENAI_KEY) if OPENAI_KEY else None
 except ImportError:
client = None

# ‚îÄ‚îÄ‚îÄ –§–æ–ª–±—ç–∫-—Å–æ–≤–µ—Ç—ã –ø–æ —Ñ–∞–∑–∞–º ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
FALLBACK_ADVICE: Dict[str, List[str]] = {
    "–ù–æ–≤–æ–ª—É–Ω–∏–µ": [
        "–ù–∞—á–Ω–∏ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Å –∫–æ—Ä–æ—Ç–∫–æ–π –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –Ω–∞ —Ü–µ–ª–∏ üßò",
        "–ó–∞–ø–∏—à–∏ —Å–≤–æ–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è –Ω–∞ –±—É–º–∞–≥–µ –∏ –¥–µ—Ä–∂–∏ –∏—Ö –Ω–∞ –≤–∏–¥—É üìù",
        "–û—á–∏—Å—Ç–∏ —Ä–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ—Ç —Ö–ª–∞–º–∞ ‚Äî —Å–≤–µ–∂—É—é —ç–Ω–µ—Ä–≥–∏—é –Ω–µ –ø–æ–º–µ—â–∞—é—Ç üìÇ",
        "–°–¥–µ–ª–∞–π digital detox –Ω–∞ —á–∞—Å ‚Äî –º–æ–∑–≥ —Å–∫–∞–∂–µ—Ç —Å–ø–∞—Å–∏–±–æ üìµ",
        "–°–æ–∑–¥–∞–π –º—É–¥–±–æ—Ä–¥ –º–µ—á—Ç—ã –≤ Pinterest –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–π—Å—è –≤–∏–∑—É–∞–ª–∞–º–∏ üìå",
        "–ó–∞–ø—É—Å—Ç–∏ —É—Ç—Ä–µ–Ω–Ω—é—é –ø—Ä–∏–≤—ã—á–∫—É: –≤—ã–ø–µ–π —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã —Å –ª–∏–º–æ–Ω–æ–º üíßüçã",
        "–ü–æ—Å—Ç–∞–≤—å –∫–æ–Ω–µ—á–Ω—É—é —Ü–µ–ª—å –º–µ—Å—è—Ü–∞ –∏ —Ä–∞–∑–±–µ–π –µ—ë –Ω–∞ –º–µ–ª–∫–∏–µ —à–∞–≥–∏ üóìÔ∏è",
        "–û—Ç–ø—Ä–∞–≤—å –¥—Ä—É–∑—å—è–º –∞–Ω–æ–Ω—Å —Å–≤–æ–∏—Ö –ø–ª–∞–Ω–æ–≤ ‚Äî —Å–æ–≤–º–µ—Å—Ç–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å üíå",
        "–ù–∞—á–Ω–∏ –≤–µ—Å—Ç–∏ –¥–Ω–µ–≤–Ω–∏–∫ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ ‚Äî –≤—Å–µ–ª–µ–Ω–Ω–∞—è –ª—é–±–∏—Ç –ø–æ–∑–∏—Ç–∏–≤ üôè",
        "–ü–æ—Å–∞–¥–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –∂–∏–≤–æ–µ –∏–ª–∏ –∫—É–ø–∏ —Å—É–∫–∫—É–ª–µ–Ω—Ç ‚Äî —Å–∏–º–≤–æ–ª —Ä–æ—Å—Ç–∞ üå±",
        "–£—Å—Ç—Ä–æ–π –º–æ–∑–≥–æ–≤–æ–π —à—Ç—É—Ä–º –≤ –æ–¥–∏–Ω–æ—á–∫—É: –Ω–∞ —Ç—Ä–∏ –∏–¥–µ–∏ –±–æ–ª—å—à–µ, —á–µ–º –æ–±—ã—á–Ω–æ üí°",
        "–ì–æ—Ç–æ–≤—å –∑–¥–æ—Ä–æ–≤—ã–π —Å–º—É–∑–∏: —Ç–µ–ª–æ —Ç–æ–∂–µ –¥–æ–ª–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è ü•§",
        "–ü—Ä–æ—á–∏—Ç–∞–π –º—É–¥—Ä—É—é —Ü–∏—Ç–∞—Ç—É –∏–∑ –∫–Ω–∏–≥–∏, –∫–æ—Ç–æ—Ä—É—é –¥–∞–≤–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª–∞ üìñ",
        "–ü–æ—Å—Ç–∞–≤—å –±—É–¥–∏–ª—å–Ω–∏–∫ –Ω–∞ 5 –º–∏–Ω—É—Ç ‚Äï —Å–¥–µ–ª–∞–π –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ üå¨Ô∏è",
        "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏ –ø—Ä–æ—à–ª–æ–π —Ñ–∞–∑—ã –∏ –æ—Ç–º–µ—Ç—å —Å–≤–æ–∏ –ø–æ–±–µ–¥—ã üèÜ",
        "–ù–∞—á–Ω–∏ –¥–µ–Ω—å —Å –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –Ω–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏—è üßò",
        "–ó–∞–ø–∏—à–∏ —Ç—Ä–∏ –≥–ª–∞–≤–Ω—ã–µ —Ü–µ–ª–∏ –Ω–∞ –º–µ—Å—è—Ü üìù",
        "–û—á–∏—Å—Ç–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–æ–∫—Ä—É–≥ —Å–µ–±—è üå±",
        "–í—ã–ø–µ–π —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã —Å –ª–∏–º–æ–Ω–æ–º –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ üíßüçã",
        "–ó–∞–¥–∞–π –Ω–∞—Å—Ç—Ä–æ–π: –Ω–∞–ø–∏—à–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏—é ‚úçÔ∏è"
    ],
    "–†–∞—Å—Ç—É—â–∞—è –õ—É–Ω–∞": [
        "–ü–ª–∞–Ω–∏—Ä—É–π –∏ –¥–µ–π—Å—Ç–≤—É–π: –ø—Ä–∏—Å—Ç—É–ø–∞–π –∫ –Ω–æ–≤—ã–º –ø—Ä–æ–µ–∫—Ç–∞–º üöÄ",
        "–í—ã–¥–µ–ª–∏ —á–∞—Å –Ω–∞ –∫—Ä–µ–∞—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é üé®",
        "–ü—Ä–æ–≤–µ–¥–∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥-—á–∞—Å —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ ü§ù",
        "–ó–∞–Ω–∏–º–∞–π—Å—è —Å–ø–æ—Ä—Ç–æ–º –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ üèÉ",
        "–û–±—É—á–∞–π—Å—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞–π –ø—Ä–æ–≥—Ä–µ—Å—Å üìö",
        "–ü–ª–∞–Ω–∏—Ä—É–π –∏ –¥–µ–π—Å—Ç–≤—É–π: –∑–∞–π–º–∏—Å—å —Å–ø–æ—Ä—Ç–æ–º –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ üèÉ",
        "–ù–∞—á–Ω–∏ –∏–∑—É—á–∞—Ç—å —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–π —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å üìö",
        "–°–æ—Å—Ç–∞–≤—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –∏ —Ä–∞–±–æ—Ç–∞–π –æ—Ç —Å–∞–º–æ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ –∫ –ø—Ä–æ—Å—Ç–æ–º—É üîù",
        "–ü—Ä–æ–≤–µ–¥–∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥-—á–∞—Å: –¥–æ–±–∞–≤—å –∫–æ–Ω—Ç–∞–∫—Ç—ã –≤ LinkedIn ü§ù",
        "–í–∫–ª—é—á–∏ —É—Ç—Ä–µ–Ω–Ω—é—é –π–æ–≥—É –¥–ª—è –∑–∞—Ä—è–¥–∫–∏ —ç–Ω–µ—Ä–≥–∏–µ–π –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å üßò‚Äç‚ôÄÔ∏è",
        "–ó–∞–∫–∞–∂–∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â—É—é –∫–Ω–∏–≥—É ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–Ω–∞–Ω–∏–π üìò",
        "–ü—Ä–æ–≤–µ–¥–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –≤–æ—Ä–∫—à–æ–ø –¥–ª—è —Å–µ–±—è: —Ä–∏—Å—É–π, –ª–µ–ø–∏, –ø—Ä–∏–¥—É–º—ã–≤–∞–π üé®",
        "–û–ø—Ä–µ–¥–µ–ª–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ —É—Å–ø–µ—Ö–∞ –∏ –ø—Ä–∞–∑–¥–Ω—É–π –º–∏–∫—Ä–æ–ø–æ–±–µ–¥—ã üéâ",
        "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –Ω–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π —Ç–µ–º–µ üéì",
        "–û–±–Ω–æ–≤–∏ —Ä–µ–∑—é–º–µ –∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ ‚Äî –ø—É—Å—Ç—å —Ä–∞—Å—Ç—ë—Ç —Ç–≤–æ—è —Ü–µ–Ω–Ω–æ—Å—Ç—å üìà",
        "–ó–∞–ø—É—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—É—é –∫–∞–º–ø–∞–Ω–∏—é –∏–ª–∏ –ª–∏—á–Ω—ã–π –±–ª–æ–≥ ‚Äî —É–≤–µ–ª–∏—á—å –æ—Ö–≤–∞—Ç üöÄ",
        "–°–æ—Å—Ç–∞–≤—å –ø–ª–∞–Ω —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–ª–∏–≤–∞–Ω–∏–π –≤ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã üí∞",
        "–ü–æ–∫–∞–∂–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –¥—Ä—É–∑—å—è–º –∏–ª–∏ –º–µ–Ω—Ç–æ—Ä—É ‚Äî –ø–æ–ª—É—á–∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å üó£Ô∏è",
        "–£—Å—Ç—Ä–æ–π power-nap –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ üí§",
        "–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π —Ü–µ–ª–∏, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏–¥—ë—Ç –Ω–µ –ø–æ –ø–ª–∞–Ω—É üîÑ"
    ],
    "–ü–µ—Ä–≤–∞—è —á–µ—Ç–≤–µ—Ä—Ç—å": [
        "–ó–∞–≤–µ—Ä—à–∏ –ø–æ–ª–æ–≤–∏–Ω—É –∑–∞–¥–∞—á –Ω–∞ —Å–µ–≥–æ–¥–Ω—è ‚úÖ",
        "–£—Å—Ç—Ä–æ–π brainstorming –ø–æ –∫–ª—é—á–µ–≤—ã–º –∏–¥–µ—è–º üí°",
        "–í—Å—Ç—Ä–µ—Ç—å—Å—è —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º –ø–æ –ø—Ä–æ–µ–∫—Ç—É ü§úü§õ",
        "–ü—Ä–æ–≤–µ—Ä—å –∑–¥–æ—Ä–æ–≤—å–µ: –∑–∞–ø–ª–∞–Ω–∏—Ä—É–π –ø—Ä–æ—Ñ–æ—Å–º–æ—Ç—Ä ü©∫",
        "–†–∞—Å—Å—Ç–∞–≤—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –±–ª–æ–∫–∏—Ä—É–π –≤—Ä–µ–º—è ‚è≥", 
        "–ò—Å–ø–æ–ª—å–∑—É–π –∏–º–ø—É–ª—å—Å: —É—Å—Ç—Ä–∞–∏–≤–∞–π –≤—Å—Ç—Ä–µ—á–∏ –∏ –æ–±—Å—É–∂–¥–∞–π –∏–¥–µ–∏ üí¨",
        "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö ‚Äî –∑–∞–≤–µ—Ä—à–∏ –ø–æ–ª–æ–≤–∏–Ω—É –ø–ª–∞–Ω–æ–≤ ‚úÖ",
        "–ó–∞–ø–ª–∞–Ω–∏—Ä—É–π –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—é —Å –∫–µ–º-—Ç–æ –∫—Ä—É—Ç—ã–º ‚Äî —Ä–æ—Å—Ç –∏–¥–µ–π –∏–¥—ë—Ç –±—ã—Å—Ç—Ä–µ–µ ü§úü§õ",
        "–ü—Ä–æ–≤–µ–¥–∏ SWOT-–∞–Ω–∞–ª–∏–∑ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ ‚Äî –≤—ã—è–≤–∏ —Å–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã üìä",
        "–ü–æ–¥–µ–ª–∏—Å—å –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö –æ–ø—ã—Ç–æ–º ‚Äî —Å–æ–∑–¥–∞–π —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç üì≤",
        "–£—Å—Ç—Ä–æ–π —á–µ–ª–ª–µ–Ω–¥–∂ –Ω–∞ –Ω–µ–¥–µ–ª—é: –ø–æ—Å—Ç–∞–≤—å —Å–µ–±–µ —Ü–µ–ª—å –∏ –∏–≥—Ä–∞–π –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º üéØ",
        "–û–±–Ω–æ–≤–∏ —Å–æ—Ñ—Ç –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Äî –ø—Ä–æ–∫–∞—á–∞–π —Ä–∞–±–æ—á–∏–π –∞—Ä—Å–µ–Ω–∞–ª üõ†Ô∏è",
        "–í–∫–ª—é—á–∏ —Ç–∞–π–º-–±–ª–æ–∫–∏–Ω–≥ –¥–ª—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –æ–¥–Ω–æ–º –¥–µ–ª–µ –∑–∞ —Ä–∞–∑ ‚è≥",
        "–ü–æ—É–∂–∏–Ω–∞–π –±–µ–∑ –≥–∞–¥–∂–µ—Ç–æ–≤ ‚Äî –¥–∞–π –º–æ–∑–≥—É –æ—Ç–¥—ã—Ö –ø–µ—Ä–µ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Ä—ã–≤–∫–æ–º üçΩÔ∏è",
        "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –∏ –≤–Ω–µ–¥—Ä–∏ —É–ª—É—á—à–µ–Ω–∏—è üìù",
        "–ü—Ä–æ–≤–µ–¥–∏ —Å–æ–≤–µ—â–∞–Ω–∏–µ-—Å—Ç–µ–Ω–¥–∞–ø —Å –∫–æ–º–∞–Ω–¥–æ–π ‚Äî –ø–æ–π–º–∞–π —Å–∏–Ω–µ—Ä–≥–∏—é üöß",
        "–ù–∞—Å—Ç—Ä–æ–π –±—É–¥–∏–ª—å–Ω–∏–∫ –Ω–∞ —É—Ç—Ä–µ–Ω–Ω–∏–π –≤–æ—Ä–∫-–∞—É—Ç ‚Äî –ø—É–ª—å—Å –±–æ–¥—Ä–æ—Å—Ç–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω üí™",
        "–ü—Ä–æ–≤–µ—Ä—å –∑–¥–æ—Ä–æ–≤—å–µ: –∑–∞–ø–ª–∞–Ω–∏—Ä—É–π –≤–∏–∑–∏—Ç –∫ –≤—Ä–∞—á—É –∏–ª–∏ —Å–¥–∞—á—É –∞–Ω–∞–ª–∏–∑–æ–≤ ü©∫",
        "–ü—Ä—ã–∂–æ–∫ –≤ —Ö–æ–ª–æ–¥–Ω—É—é –≤–æ–¥—É (–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–π –¥—É—à) –¥–ª—è –∑–∞—Ä—è–¥–∫–∏ ‚ö°",
        "–í—ã–ø–∏—à–∏ –∏–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –∫–∞–∂—É—Ç—Å—è –±–µ–∑—É–º–Ω—ã–º–∏ ‚Äî –∏–Ω–æ–≥–¥–∞ –∏–∑ –Ω–∏—Ö —Ä–æ–∂–¥–∞–µ—Ç—Å—è –≥–µ–Ω–∏–∞–ª—å–Ω–æ–µ ü§Ø"
    ],
    "–ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ": [
        "–û—Ç–¥–æ—Ö–Ω–∏ –ø–æ–¥ –ª—É–Ω–æ–π: —Ä–∞—Å—Å–ª–∞–±—å—Å—è –≤ —Ç—ë–ø–ª–æ–π –≤–∞–Ω–Ω–µ üõÅ",
        "–ó–∞–∫—Ä–æ–π –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –¥–µ–ª–∞ –∏ –æ—Ç–ø—Ä–∞–∑–¥–Ω—É–π —É—Å–ø–µ—Ö üéâ",
        "–ü—Ä–æ–≤–µ–¥–∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–µ—á–µ—Ä: —Ä–∏—Å—É–π –∏–ª–∏ –ø–∏—à–∏ ‚úçÔ∏è",
        "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –±—é–¥–∂–µ—Ç –∏ —É–±–µ—Ä–∏ –ª–∏—à–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã üí∏",
        "–ü—Ä–æ–≤–µ–¥–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—é –Ω–∞ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ –≤—Å–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ üå¨Ô∏è",
        "–ó–∞–∫—Ä–æ–π –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –¥–µ–ª–∞ –∏ –æ—Ç–¥–æ—Ö–Ω–∏ –ø–æ–¥ –ª—É–Ω–Ω—ã–º —Å–≤–µ—Ç–æ–º üåï",
        "–ü—Ä–æ–≤–µ–¥–∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–µ—á–µ—Ä: —Ä–∏—Å—É–π –∏–ª–∏ –ø–∏—à–∏ üé®",
        "–£—Å—Ç—Ä–æ–π –ª—É–Ω–Ω—É—é –≤–∞–Ω–Ω—É: —Ä–∞—Å—Å–ª–∞–±—å—Å—è –≤ —Ç—ë–ø–ª–æ–π –≤–∞–Ω–Ω–µ —Å —Å–æ–ª—å—é üõÅ",
        "–ü—Ä–æ–≤–µ—Ä—å –±—é–¥–∂–µ—Ç: –∏–∑–±–∞–≤—å—Å—è –æ—Ç –ª–∏—à–Ω–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ üí∏",
        "–£—Å—Ç—Ä–æ–π —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—É—é –≤–µ—á–µ—Ä–∏–Ω–∫—É –¥–ª—è –æ–¥–Ω–æ–≥–æ ‚Äî –æ—Ç–ø—É—Å—Ç–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ üíÉ",
        "–ü–∏—à–∏ –±–ª–∞–≥–æ–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞ —Ç–µ–º, –∫—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–±—è üíå",
        "–£—Å—Ç—Ä–æ–π —Ñ–æ—Ç–æ-—Å–µ—Å—Å–∏—é –ø—Ä–∏ –ª—É–Ω–Ω–æ–º —Å–≤–µ—Ç–µ ‚Äî –ø–æ–π–º–∞–π –º–∞–≥–∏—é üì∑",
        "–ü—Ä–æ–≤–µ–¥–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—é –Ω–∞ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ ‚Äî –æ—Ç–ø—É—Å—Ç–∏ –Ω–µ–Ω—É–∂–Ω–æ–µ üîì",
        "–°–ª—É—à–∞–π —Ç–∏–±–µ—Ç—Å–∫–∏–µ —á–∞—à–∏ –∏–ª–∏ –ª—É–Ω–Ω—ã–µ –ø–ª–µ–µ—Ä–∞ –¥–ª—è –≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —á–∏—Å—Ç–∫–∏ üé∂",
        "–ü—Ä–æ–≥—É–ª—è–π—Å—è –Ω–æ—á—å—é –ø–æ–¥ –ª—É–Ω–æ–π ‚Äî –Ω–∞—Å—Ç—Ä–æ–π –±–∏–æ—Ä–∏—Ç–º—ã üö∂‚Äç‚ôÄÔ∏è",
        "–°–æ–±–µ—Ä–∏ –ª—É–Ω–Ω—ã–π —ç–ª–∏–∫—Å–∏—Ä –∏–∑ —Ç—Ä–∞–≤ –¥–ª—è —Å–Ω–∞ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è üåø",
        "–í—ã–ø–æ–ª–Ω–∏ –ø–∏—Å—å–º–µ–Ω–Ω—ã–π —Ä–∏—Ç—É–∞–ª –ø—Ä–æ—â–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ ‚úçÔ∏è",
        "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –Ω–µ–±–æ –≤ —Ç–µ–ª–µ—Å–∫–æ–ø ‚Äî –ø–æ–¥–∑–∞—Ä—è–¥–∏—Å—å –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π üî≠",
        "–ü—Ä–æ–≤–µ–¥–∏ –≤–µ—á–µ—Ä ¬´–¥–µ—Ç–æ–∫—Å –æ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π¬ª ‚Äî –ø–æ–≥—Ä—É–∑–∏—Å—å –≤ —Å–µ–±—è üìµ",
        "–°–¥–µ–ª–∞–π –≤–µ—á–µ—Ä–Ω–∏–π —Å—Ç—Ä–∏–º –∏–ª–∏ —Å—Ç–æ—Ä–∏—Å –æ —Å–≤–æ–∏—Ö –æ—â—É—â–µ–Ω–∏—è—Ö –ø—Ä–∏ –ø–æ–ª–Ω–æ–ª—É–Ω–∏–∏ üìπ"
    ],
    "–£–±—ã–≤–∞—é—â–∞—è –õ—É–Ω–∞": [
        "–ü—Ä–æ–≤–µ–¥–∏ —Ä–∏—Ç—É–∞–ª –æ—á–∏—â–µ–Ω–∏—è: —É–±–µ—Ä–∏ —Å—Ç–∞—Ä–æ–µ üïØÔ∏è",
        "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏ –∏ —Å–ø–ª–∞–Ω–∏—Ä—É–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ üîÑ",
        "–û—Ç–º–µ–Ω–∏ –ª–∏—à–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –æ—á–∏—Å—Ç–∏ –ø–æ—á—Ç—É üìß",
        "–£—Å—Ç—Ä–æ–π –¥–µ–Ω—å —Ç–∏—à–∏–Ω—ã –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è ü§´",
        "–ü—Ä–æ–≤–µ–¥–∏ –ª—ë–≥–∫—É—é —Ä–∞—Å—Ç—è–∂–∫—É –∏–ª–∏ –π–æ–≥—É üßò‚Äç‚ôÇÔ∏è",
        "–†–∏—Ç—É–∞–ª –æ—á–∏—â–µ–Ω–∏—è: –∏–∑–±–∞–≤—å—Å—è –æ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö –≤–µ—â–µ–π üïØÔ∏è",
        "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏ –∏ –∑–∞–ø–ª–∞–Ω–∏—Ä—É–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ üîÑ",
        "–°–æ—Å—Ç–∞–≤—å —Å–ø–∏—Å–æ–∫ ¬´—á—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ¬ª –∏ –±—É–¥—å —á–µ—Å—Ç–Ω–∞ —Å —Å–æ–±–æ–π üìã",
        "–û—Ç–ø–∏—à–∏—Å—å –æ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ –∏ –æ—á–∏—Å—Ç–∏ –ø–æ—á—Ç—É üìß",
        "–ü—Ä–æ–≤–µ–¥–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—é –Ω–∞ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ ‚Äî –≤—ã–¥–æ—Öni –≤—Å—ë –ª–∏—à–Ω–µ–µ üå¨Ô∏è",
        "–£—Å—Ç—Ä–æ–π ¬´–¥–µ–Ω—å –º–æ–ª—á–∞–Ω–∏—è¬ª ‚Äî –Ω–∞–±–ª—é–¥–∞–π –∑–∞ –º—ã—Å–ª—è–º–∏ –±–µ–∑ —Ä–µ–∞–∫—Ü–∏–∏ ü§´",
        "–ú–∞—Å—Å–∞–∂ –∏–ª–∏ —Å–∞–º–æ–º–∞—Å—Å–∞–∂ –¥–ª—è —Å–Ω—è—Ç–∏—è –Ω–∞–∫–æ–ø–∏–≤—à–µ–≥–æ—Å—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è üíÜ‚Äç‚ôÄÔ∏è",
        "–ü—Ä–æ–≤–µ–¥–∏ –¥–µ—Ç–æ–∫—Å-–¥–∏–µ—Ç—É –Ω–∞ –æ–≤–æ—â–∞—Ö –∏ —Å—É–ø–∞—Ö ü•£",
        "–£—Å—Ç—Ä–æ–π –≤–µ—á–µ—Ä –ª–µ–≥–∫–æ–π —Ä–∞—Å—Ç—è–∂–∫–∏ –∏ –π–æ–≥–∏ –Ω–∏–¥—Ä—ã üßò‚Äç‚ôÇÔ∏è",
        "–°–≤–µ—Ä—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –≤—ã—á–µ—Ä–∫–Ω–∏ —Ç–æ, —á—Ç–æ –Ω–µ —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç üö´",
        "–ù–∞–ø–∏—à–∏ –ø–∏—Å—å–º–æ —Å –ø—Ä–æ—â–µ–Ω–∏–µ–º —Å–µ–±–µ –∏ –ª—é–¥—è–º, –∫—Ç–æ –ø—Ä–∏—á–∏–Ω—è–ª –±–æ–ª—å ‚úâÔ∏è",
        "–û—Ç–º–µ–Ω–∏ –ø–ª–∞–Ω—ã, –µ—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—à—å –ø–µ—Ä–µ–≥—Ä—É–∑ ‚Äî –æ—Ç–¥—ã—Ö –Ω–µ —Ä–æ—Å–∫–æ—à—å üõå",
        "–ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–ø–∏—Å–∫–∏ –∏ ¬´–ª–∞–π–∫–∏¬ª ‚Äî —É–¥–∞–ª—è–π –≤—Å–µ –ª–∏—à–Ω–µ–µ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö üëçüëé",
        "–ü—Ä–æ–≤–µ–¥–∏ —Ä–∏—Ç—É–∞–ª —Å –æ–≥–Ω—ë–º (—Å–≤–µ—á–∞ –∏–ª–∏ –∫–æ—Å—Ç—ë—Ä) –¥–ª—è —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ —Å–∂–∏–≥–∞–Ω–∏—è —Ö–ª–∞–º–∞ üî•",
        "–ó–∞–ø–ª–∞–Ω–∏—Ä—É–π SPA-–¥–µ–Ω—å –∏–ª–∏ –¥–æ–º–∞—à–Ω–∏–π —Ä–µ–ª–∞–∫—Å-—Ä–∏—Ç—É–∞–ª üßñ‚Äç‚ôÄÔ∏è"
    ],
    "–ü–æ—Å–ª–µ–¥–Ω—è—è —á–µ—Ç–≤–µ—Ä—Ç—å": [
        "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –∏—Ç–æ–≥–∏ —Ü–∏–∫–ª–∞ –∏ —Ä–∞—Å—Å–ª–∞–±—å—Å—è üõÄ",
        "–°–æ—Å—Ç–∞–≤—å —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –∏ –≤—ã–≤–æ–¥–æ–≤ üìã",
        "–ü–ª–∞–Ω–∏—Ä—É–π –æ—Ç–¥—ã—Ö –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ üåø",
        "–ü—Ä–æ–≤–µ–¥–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–π –¥–µ—Ç–æ–∫—Å: –æ—Ç–∫–ª—é—á–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è üìµ",
        "–ó–∞–ø–∏—à–∏ –º–∞–Ω—Ç—Ä—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª üè∑Ô∏è",
        "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é –∏ —Ä–∞—Å—Å–ª–∞–±—å—Å—è üõÅ",
        "–ó–∞–π–º–∏—Å—å –º–µ–¥–∏—Ç–∞—Ü–∏–µ–π –∏–ª–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π üå¨Ô∏è",
        "–°–æ—Å—Ç–∞–≤—å –æ—Ç—á—ë—Ç –æ —Å–≤–æ–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö ‚Äî –ø–æ–≥–ª–∞–¥—å —Å–µ–±—è –ø–æ –ø–ª–µ—á—É üìà",
        "–ù–∞–ø–∏—à–∏ —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –∏ –≤—ã–≤–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–Ω–µ—Å–ª–∞ –∑–∞ —Ü–∏–∫–ª üìù",
        "–ü–æ—Å—Ç—Ä–æ–π –ø–ª–∞–Ω –Ω–∞ –±–ª–∏–∂–∞–π—à—É—é –Ω–µ–¥–µ–ª—é —Å —É—á—ë—Ç–æ–º –æ—Ç–¥—ã—Ö–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è üìÖ",
        "–£—Å—Ç—Ä–æ–π –º–æ–ª—á–∞–ª–∏–≤—ã–π —Ä–µ—Ç—Ä–∏—Ç —Ö–æ—Ç—è –±—ã –Ω–∞ —á–∞—Å ‚Äî —Å–ª—É—à–∞–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å ü§´",
        "–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ —Ü–µ–ª–∏: —á—Ç–æ —Å—Ç–æ–∏—Ç –æ—Å—Ç–∞–≤–∏—Ç—å, –∞ —á—Ç–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å üîç",
        "–ü—Ä–æ—á–∏—Ç–∞–π –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â—É—é —Å—Ç–∞—Ç—å—é –∏–ª–∏ –∫–Ω–∏–≥—É –æ –ª–∏—á–Ω–æ—Å—Ç–Ω–æ–º —Ä–∞–∑–≤–∏—Ç–∏–∏ üìñ",
        "–°–¥–µ–ª–∞–π —Ä–µ–≤–∏–∑–∏—é –ø—Ä–∏–≤—ã—á–µ–∫ –∏ –∏–∑–±–∞–≤—å—Å—è –æ—Ç –≤—Ä–µ–¥–Ω—ã—Ö üö≠",
        "–£—Å—Ç—Ä–æ–π —É–∂–∏–Ω —Å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∏ –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–µ–º üçú",
        "–°–æ—Å—Ç–∞–≤—å –º–∞–Ω–∏—Ñ–µ—Å—Ç –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ –∏ –ø–æ—á–∏—Ç–∞–π –µ–≥–æ –≤—Å–ª—É—Ö üôå",
        "–ü—Ä–æ–≤–µ–¥–∏ —Å–µ–∞–Ω—Å —Ü–∏–≥—É–Ω –∏–ª–∏ –º—è–≥–∫–æ–π —É—Ç—Ä–µ–Ω–Ω–µ–π –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∏ ‚òØÔ∏è",
        "–ü–æ—Å—Ç–∞–≤—å —Å–µ–±–µ –º–∞–Ω—Ç—Ä—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª –∏ –∑–∞–ø–∏—à–∏ –µ—ë –Ω–∞ —Å—Ç–∏–∫–µ—Ä üè∑Ô∏è",
        "–û—Ä–≥–∞–Ω–∏–∑—É–π digital-–∞—Ä—Ö–∏–≤: —É–¥–∞–ª–∏ –¥—É–±–ª–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ üóÇÔ∏è",
        "–°–¥–µ–ª–∞–π –ø–ª–∞–Ω —Å–Ω–∞: –ª—è–≥ –≤–æ–≤—Ä–µ–º—è –∏ –Ω–∞—Å—Ç—Ä–æ–π –ø—Ä–∏—è—Ç–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É üí§"
    ],
}

# ‚îÄ‚îÄ‚îÄ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–Ω–µ–π (–ø—Ä–∏–º–µ—Ä –ø–æ –≤–∞—à–∏–º —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
CATEGORIES = {
    "general": {
        "favorable":   [1, 2, 3, 4, 7, 28, 29],
        "unfavorable": [13, 20, 23, 24, 27],
    },
    "haircut": {
        "favorable":   [1, 2, 4, 7, 9, 10, 18, 19, 24, 25, 31],
        "unfavorable": [],
    },
    "travel": {
        "favorable":   [5, 7, 14, 15],
        "unfavorable": [],
    },
    "shopping": {
        "favorable":   [3, 6, 9, 12, 14, 17, 20, 25],
        "unfavorable": [13, 20, 23, 24, 27],
    },
    "health": {
        "favorable":   [1, 2, 3, 4, 7, 28, 29],
        "unfavorable": [],
    },
}

def compute_lunar_phase(d: pendulum.Date) -> Tuple[str,int]:
    """–£–ø—Ä–æ—â—ë–Ω–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º —Ñ–∞–∑—É –õ—É–Ω—ã –∏ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç–∏."""
    SYNODIC = 29.530588853
    ref = pendulum.date(2025,5,11)  # –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –Ω–æ–≤–æ–ª—É–Ω–∏–µ
    age = (d - ref).days % SYNODIC
    pct = int(round(abs(1 - abs((age/SYNODIC)*2 - 1)) * 100))
    if age < 1:
        name = "–ù–æ–≤–æ–ª—É–Ω–∏–µ"
    elif age < SYNODIC*0.25:
        name = "–†–∞—Å—Ç—É—â–∞—è –õ—É–Ω–∞"
    elif age < SYNODIC*0.5:
        name = "–ü–µ—Ä–≤–∞—è —á–µ—Ç–≤–µ—Ä—Ç—å"
    elif age < SYNODIC*0.75:
        name = "–ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ"
    elif age < SYNODIC*0.875:
        name = "–£–±—ã–≤–∞—é—â–∞—è –õ—É–Ω–∞"
    else:
        name = "–ü–æ—Å–ª–µ–¥–Ω—è—è —á–µ—Ç–≤–µ—Ä—Ç—å"
    # –ø—Ä–∏–≤—è–∂–µ–º ¬´–∑–Ω–∞–∫¬ª –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
    SIGNS = ["–û–≤–Ω–µ","–¢–µ–ª—å—Ü–µ","–ë–ª–∏–∑–Ω–µ—Ü–∞—Ö","–†–∞–∫–µ","–õ—å–≤–µ","–î–µ–≤–µ",
             "–í–µ—Å–∞—Ö","–°–∫–æ—Ä–ø–∏–æ–Ω–µ","–°—Ç—Ä–µ–ª—å—Ü–µ","–ö–æ–∑–µ—Ä–æ–≥–µ","–í–æ–¥–æ–ª–µ–µ","–†—ã–±–∞—Ö"]
    sign = SIGNS[(d.day + d.month) % 12]
    phase_str = f"{name} –≤ {sign} ({pct}% –æ—Å–≤–µ—â.)"
    return phase_str, pct

def compute_advice_list(d: pendulum.Date, phase_str: str) -> List[str]:
    """–°–æ–±–∏—Ä–∞–µ–º 3 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–≤–µ—Ç–∞ –¥–ª—è –¥–Ω—è."""
    phase_name = phase_str.split(" –≤ ")[0]
    pool = FALLBACK_ADVICE.get(phase_name, ["–ù–∞—Å–ª–∞–¥–∏—Å—å –ª—É–Ω–Ω—ã–º —Å–≤–µ—Ç–æ–º üåô"])
    # –µ—Å–ª–∏ –µ—Å—Ç—å GPT ‚Äî –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –µ–≥–æ 1 —Ä–∞–∑ –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫
    # —É–ø—Ä–æ—â—ë–Ω–Ω–æ –±–µ—Ä—ë–º —Å–ª—É—á–∞–π–Ω—ã–µ 3 —Å–æ–≤–µ—Ç–∞
    return random.sample(pool, k=min(3, len(pool)))

def compute_next_event_map(cal: Dict[str,Any]]) -> Dict[str,str]:
    """–î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –Ω–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à–µ–µ –Ω–æ–≤–æ–ª—É–Ω–∏–µ –∏–ª–∏ –ø–æ–ª–Ω–æ–ª—É–Ω–∏–µ."""
    dates = list(cal.keys())
    phases = {d: cal[d]["phase"] for d in dates}
    result: Dict[str,str] = {}
    for d0 in dates:
        dd0 = pendulum.parse(d0)
        # –∏—â–µ–º —Å–ª–µ–¥—É—é—â–∏–π full/new
        future = [pendulum.parse(d) for d in dates if pendulum.parse(d)>dd0]
        nxt = None
        for d1 in future:
            if "–ù–æ–≤–æ–ª—É–Ω–∏–µ" in phases[d1.to_date_string()] or "–ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ" in phases[d1.to_date_string()]:
                nxt = d1
                break
        if nxt:
            delta = (nxt - dd0).days
            ph = phases[nxt.to_date_string()]
            result[d0] = f"‚Üí –ß–µ—Ä–µ–∑ {delta} –¥–Ω—è {ph}"
        else:
            result[d0] = "‚Üí –°–ª–µ–¥—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ —Å–∫–æ—Ä–æ‚Ä¶"
    return result

def generate_calendar(year:int, month:int) -> Dict[str,Dict[str,Any]]:
    start = pendulum.date(year,month,1)
    end = start.end_of('month')
    cal:Dict[str,Dict[str,Any]] = {}
    d = start
    while d <= end:
        phase_str,_ = compute_lunar_phase(d)
        advice = compute_advice_list(d, phase_str)
        cal[d.to_date_string()] = {
            "phase": phase_str,
            "advice": advice,
            # placeholder, –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ–º –Ω–∏–∂–µ
            "next_event": "",
            "favorable_days": {cat: CATEGORIES[cat]["favorable"] for cat in CATEGORIES},
            "unfavorable_days": {cat: CATEGORIES[cat]["unfavorable"] for cat in CATEGORIES},
        }
        d = d.add(days=1)
    # –∑–∞–ø–æ–ª–Ω–∏—Ç—å next_event –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è
    nxtmap = compute_next_event_map(cal)
    for key in cal:
        cal[key]["next_event"] = nxtmap[key]
    return cal

def main():
    today = pendulum.today()
    data = generate_calendar(today.year, today.month)
    out = Path(__file__).parent / "lunar_calendar.json"
    out.write_text(json.dumps(data, ensure_ascii=False, indent=2), encoding="utf-8")
    print(f"‚úÖ lunar_calendar.json —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è {today.format('MMMM YYYY')}")

if __name__ == "__main__":
    main()
