name: Daily VayboMeter Post

    on:
  schedule:
    # 18:00 UTC  = 21:00 Asia/Nicosia (летом)
    - cron: '0 18 * * *'
  workflow_dispatch:

jobs:
  post:
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Checkout repo
        uses: actions/checkout@v3

      - name: 🐍 Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: 📦 Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt  \
              requests python-dateutil pendulum astropy

      - name: 🚀 Run VayboМетр poster
        env:
          # ───── обязательные ─────
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHANNEL_ID:     ${{ secrets.CHANNEL_ID }}
          # ───── новые для фактических данных ─────
          OWM_KEY:        ${{ secrets.OWM_KEY }}          # OpenWeather
          AIRVISUAL_KEY:  ${{ secrets.AIRVISUAL_KEY }}    # IQAir / AirVisual
          AMBEE_KEY:      ${{ secrets.AMBEE_KEY }}        # Pollen (Ambee) — по желанию
          COPERNICUS_USER: ${{ secrets.COPERNICUS_USER }} # Copernicus Marine SST
          COPERNICUS_PASS: ${{ secrets.COPERNICUS_PASS }}
        run: python post.py
